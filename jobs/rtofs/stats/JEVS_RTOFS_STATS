#!/bin/bash
###############################################################################
# Job Name: JEVS_RTOFS_STATS
# Purpose: To create stat files for RTOFS forecast verification using
#          MET/METplus.
# Author: L. Gwen Chen (lichuan.chen@noaa.gov)
###############################################################################

set -x

# set up paths
export FIXevs=${FIXevs:-$EVS/fix}
export CONFIGevs=${CONFIGevs:-$EVS/parm/metplus_config/$COMPONENT}

# define COMIN/COMOUT variables
export COMIN=${COMIN:-$(compath.py $envir/com/$NET/${evs_ver})}
export COMINgdas=${COMINgdas:-$(compath.py $envir/com/obsproc/${obsproc_ver}/gdas)}
export COMINobs=${COMINobs:-$(compath.py $envir/dcom)}
export COMINfcst=${COMINfcst:-$(compath.py $NET/${evs_ver}/prep/$COMPONENT)}
export COMINclimo=${COMINclimo:-$EVS/fix/climos/$COMPONENT}
export COMOUT=${COMOUT:-$(compath.py $NET/${evs_ver})}
export COMOUTfinal=${COMOUTfinal:-$COMOUT/$STEP/$COMPONENT/$COMPONENT.$VDATE}

# run scripts for each RUN;
# RUN is the validation source: gmpe, smos, smap etc.
for rcase in gmpe smos smap aviso osisaf; do
  export RUN=$rcase
  export VERIF_CASE=grid2grid
  export COMOUTsmall=$COMOUT/$STEP/$COMPONENT/$RUN.$VDATE

  if [ $rcase = 'gmpe' ] ; then
     export RUNupper=GMPE
     export VAR=sst
  fi

  if [ $rcase = 'smos' ] ; then
     export RUNupper=SMOS
     export VAR=sss
  fi

  if [ $rcase = 'smap' ] ; then
     export RUNupper=SMAP
     export VAR=sss
  fi

  if [ $rcase = 'aviso' ] ; then
     export RUNupper=AVISO
     export VAR=ssh
  fi

  if [ $rcase = 'osisaf' ] ; then
     export RUNupper=OSISAF
     export VAR=sic
  fi

  $EVS/scripts/$COMPONENT/$STEP/exevs_${COMPONENT}_${RUN}_${STEP}.sh
done

# run Buoys grid2obs verifications
export RUN=buoys
export RUNupper=SFCSHP
export VAR=sst
export VERIF_CASE=grid2obs
export COMOUTsmall=$COMOUT/$STEP/$COMPONENT/$RUN.$VDATE

$EVS/scripts/$COMPONENT/$STEP/exevs_${COMPONENT}_${RUN}_${STEP}.sh

################################# END OF JOB ##################################
